{"ast":null,"code":"'use strict';\n\nvar Fx = require('../../components/fx');\n\nvar Lib = require('../../lib');\n\nvar constants = require('./constants');\n\nmodule.exports = function hoverPoints(pointData, xval, yval) {\n  var cd0 = pointData.cd[0];\n  var trace = cd0.trace;\n  var xa = pointData.xa;\n  var ya = pointData.ya; // Return early if not on image\n\n  if (Fx.inbox(xval - cd0.x0, xval - (cd0.x0 + cd0.w * trace.dx), 0) > 0 || Fx.inbox(yval - cd0.y0, yval - (cd0.y0 + cd0.h * trace.dy), 0) > 0) {\n    return;\n  } // Find nearest pixel's index\n\n\n  var nx = Math.floor((xval - cd0.x0) / trace.dx);\n  var ny = Math.floor(Math.abs(yval - cd0.y0) / trace.dy);\n  var pixel;\n\n  if (trace._hasZ) {\n    pixel = cd0.z[ny][nx];\n  } else if (trace._hasSource) {\n    pixel = trace._canvas.el.getContext('2d').getImageData(nx, ny, 1, 1).data;\n  } // return early if pixel is undefined\n\n\n  if (!pixel) return;\n  var hoverinfo = cd0.hi || trace.hoverinfo;\n  var fmtColor;\n\n  if (hoverinfo) {\n    var parts = hoverinfo.split('+');\n    if (parts.indexOf('all') !== -1) parts = ['color'];\n    if (parts.indexOf('color') !== -1) fmtColor = true;\n  }\n\n  var cr = constants.colormodel[trace.colormodel];\n  var colormodel = cr.colormodel || trace.colormodel;\n  var dims = colormodel.length;\n\n  var c = trace._scaler(pixel);\n\n  var s = cr.suffix;\n  var colorstring = [];\n\n  if (trace.hovertemplate || fmtColor) {\n    colorstring.push('[' + [c[0] + s[0], c[1] + s[1], c[2] + s[2]].join(', '));\n    if (dims === 4) colorstring.push(', ' + c[3] + s[3]);\n    colorstring.push(']');\n    colorstring = colorstring.join('');\n    pointData.extraText = colormodel.toUpperCase() + ': ' + colorstring;\n  }\n\n  var text;\n\n  if (Array.isArray(trace.hovertext) && Array.isArray(trace.hovertext[ny])) {\n    text = trace.hovertext[ny][nx];\n  } else if (Array.isArray(trace.text) && Array.isArray(trace.text[ny])) {\n    text = trace.text[ny][nx];\n  } // TODO: for color model with 3 dims, display something useful for hovertemplate `%{color[3]}`\n\n\n  var py = ya.c2p(cd0.y0 + (ny + 0.5) * trace.dy);\n  var xVal = cd0.x0 + (nx + 0.5) * trace.dx;\n  var yVal = cd0.y0 + (ny + 0.5) * trace.dy;\n  var zLabel = '[' + pixel.slice(0, trace.colormodel.length).join(', ') + ']';\n  return [Lib.extendFlat(pointData, {\n    index: [ny, nx],\n    x0: xa.c2p(cd0.x0 + nx * trace.dx),\n    x1: xa.c2p(cd0.x0 + (nx + 1) * trace.dx),\n    y0: py,\n    y1: py,\n    color: c,\n    xVal: xVal,\n    xLabelVal: xVal,\n    yVal: yVal,\n    yLabelVal: yVal,\n    zLabelVal: zLabel,\n    text: text,\n    hovertemplateLabels: {\n      'zLabel': zLabel,\n      'colorLabel': colorstring,\n      'color[0]Label': c[0] + s[0],\n      'color[1]Label': c[1] + s[1],\n      'color[2]Label': c[2] + s[2],\n      'color[3]Label': c[3] + s[3]\n    }\n  })];\n};","map":{"version":3,"sources":["C:/Projects/reactApp/analyse_coderhub/node_modules/plotly.js/src/traces/image/hover.js"],"names":["Fx","require","Lib","constants","module","exports","hoverPoints","pointData","xval","yval","cd0","cd","trace","xa","ya","inbox","x0","w","dx","y0","h","dy","nx","Math","floor","ny","abs","pixel","_hasZ","z","_hasSource","_canvas","el","getContext","getImageData","data","hoverinfo","hi","fmtColor","parts","split","indexOf","cr","colormodel","dims","length","c","_scaler","s","suffix","colorstring","hovertemplate","push","join","extraText","toUpperCase","text","Array","isArray","hovertext","py","c2p","xVal","yVal","zLabel","slice","extendFlat","index","x1","y1","color","xLabelVal","yLabelVal","zLabelVal","hovertemplateLabels"],"mappings":"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","sourcesContent":["'use strict';\n\nvar Fx = require('../../components/fx');\nvar Lib = require('../../lib');\nvar constants = require('./constants');\n\nmodule.exports = function hoverPoints(pointData, xval, yval) {\n    var cd0 = pointData.cd[0];\n    var trace = cd0.trace;\n    var xa = pointData.xa;\n    var ya = pointData.ya;\n\n    // Return early if not on image\n    if(Fx.inbox(xval - cd0.x0, xval - (cd0.x0 + cd0.w * trace.dx), 0) > 0 ||\n            Fx.inbox(yval - cd0.y0, yval - (cd0.y0 + cd0.h * trace.dy), 0) > 0) {\n        return;\n    }\n\n    // Find nearest pixel's index\n    var nx = Math.floor((xval - cd0.x0) / trace.dx);\n    var ny = Math.floor(Math.abs(yval - cd0.y0) / trace.dy);\n\n    var pixel;\n    if(trace._hasZ) {\n        pixel = cd0.z[ny][nx];\n    } else if(trace._hasSource) {\n        pixel = trace._canvas.el.getContext('2d').getImageData(nx, ny, 1, 1).data;\n    }\n\n    // return early if pixel is undefined\n    if(!pixel) return;\n\n    var hoverinfo = cd0.hi || trace.hoverinfo;\n    var fmtColor;\n    if(hoverinfo) {\n        var parts = hoverinfo.split('+');\n        if(parts.indexOf('all') !== -1) parts = ['color'];\n        if(parts.indexOf('color') !== -1) fmtColor = true;\n    }\n\n    var cr = constants.colormodel[trace.colormodel];\n    var colormodel = cr.colormodel || trace.colormodel;\n    var dims = colormodel.length;\n    var c = trace._scaler(pixel);\n    var s = cr.suffix;\n\n    var colorstring = [];\n    if(trace.hovertemplate || fmtColor) {\n        colorstring.push('[' + [c[0] + s[0], c[1] + s[1], c[2] + s[2]].join(', '));\n        if(dims === 4) colorstring.push(', ' + c[3] + s[3]);\n        colorstring.push(']');\n        colorstring = colorstring.join('');\n        pointData.extraText = colormodel.toUpperCase() + ': ' + colorstring;\n    }\n\n    var text;\n    if(Array.isArray(trace.hovertext) && Array.isArray(trace.hovertext[ny])) {\n        text = trace.hovertext[ny][nx];\n    } else if(Array.isArray(trace.text) && Array.isArray(trace.text[ny])) {\n        text = trace.text[ny][nx];\n    }\n\n    // TODO: for color model with 3 dims, display something useful for hovertemplate `%{color[3]}`\n    var py = ya.c2p(cd0.y0 + (ny + 0.5) * trace.dy);\n    var xVal = cd0.x0 + (nx + 0.5) * trace.dx;\n    var yVal = cd0.y0 + (ny + 0.5) * trace.dy;\n    var zLabel = '[' + pixel.slice(0, trace.colormodel.length).join(', ') + ']';\n    return [Lib.extendFlat(pointData, {\n        index: [ny, nx],\n        x0: xa.c2p(cd0.x0 + nx * trace.dx),\n        x1: xa.c2p(cd0.x0 + (nx + 1) * trace.dx),\n        y0: py,\n        y1: py,\n        color: c,\n        xVal: xVal,\n        xLabelVal: xVal,\n        yVal: yVal,\n        yLabelVal: yVal,\n        zLabelVal: zLabel,\n        text: text,\n        hovertemplateLabels: {\n            'zLabel': zLabel,\n            'colorLabel': colorstring,\n            'color[0]Label': c[0] + s[0],\n            'color[1]Label': c[1] + s[1],\n            'color[2]Label': c[2] + s[2],\n            'color[3]Label': c[3] + s[3]\n        }\n    })];\n};\n"]},"metadata":{},"sourceType":"script"}