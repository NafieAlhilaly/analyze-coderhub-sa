{"ast":null,"code":"'use strict';\n\nvar d3 = require('@plotly/d3');\n\nvar Lib = require('../../lib');\n\nvar Drawing = require('../../components/drawing');\n\nvar BADNUM = require('../../constants/numerical').BADNUM;\n\nvar barPlot = require('../bar/plot');\n\nvar clearMinTextSize = require('../bar/uniform_text').clearMinTextSize;\n\nmodule.exports = function plot(gd, plotinfo, cdModule, traceLayer) {\n  var fullLayout = gd._fullLayout;\n  clearMinTextSize('funnel', fullLayout);\n  plotConnectorRegions(gd, plotinfo, cdModule, traceLayer);\n  plotConnectorLines(gd, plotinfo, cdModule, traceLayer);\n  barPlot.plot(gd, plotinfo, cdModule, traceLayer, {\n    mode: fullLayout.funnelmode,\n    norm: fullLayout.funnelmode,\n    gap: fullLayout.funnelgap,\n    groupgap: fullLayout.funnelgroupgap\n  });\n};\n\nfunction plotConnectorRegions(gd, plotinfo, cdModule, traceLayer) {\n  var xa = plotinfo.xaxis;\n  var ya = plotinfo.yaxis;\n  Lib.makeTraceGroups(traceLayer, cdModule, 'trace bars').each(function (cd) {\n    var plotGroup = d3.select(this);\n    var trace = cd[0].trace;\n    var group = Lib.ensureSingle(plotGroup, 'g', 'regions');\n\n    if (!trace.connector || !trace.connector.visible) {\n      group.remove();\n      return;\n    }\n\n    var isHorizontal = trace.orientation === 'h';\n    var connectors = group.selectAll('g.region').data(Lib.identity);\n    connectors.enter().append('g').classed('region', true);\n    connectors.exit().remove();\n    var len = connectors.size();\n    connectors.each(function (di, i) {\n      // don't draw lines between nulls\n      if (i !== len - 1 && !di.cNext) return;\n      var xy = getXY(di, xa, ya, isHorizontal);\n      var x = xy[0];\n      var y = xy[1];\n      var shape = '';\n\n      if (x[0] !== BADNUM && y[0] !== BADNUM && x[1] !== BADNUM && y[1] !== BADNUM && x[2] !== BADNUM && y[2] !== BADNUM && x[3] !== BADNUM && y[3] !== BADNUM) {\n        if (isHorizontal) {\n          shape += 'M' + x[0] + ',' + y[1] + 'L' + x[2] + ',' + y[2] + 'H' + x[3] + 'L' + x[1] + ',' + y[1] + 'Z';\n        } else {\n          shape += 'M' + x[1] + ',' + y[1] + 'L' + x[2] + ',' + y[3] + 'V' + y[2] + 'L' + x[1] + ',' + y[0] + 'Z';\n        }\n      }\n\n      if (shape === '') shape = 'M0,0Z';\n      Lib.ensureSingle(d3.select(this), 'path').attr('d', shape).call(Drawing.setClipUrl, plotinfo.layerClipId, gd);\n    });\n  });\n}\n\nfunction plotConnectorLines(gd, plotinfo, cdModule, traceLayer) {\n  var xa = plotinfo.xaxis;\n  var ya = plotinfo.yaxis;\n  Lib.makeTraceGroups(traceLayer, cdModule, 'trace bars').each(function (cd) {\n    var plotGroup = d3.select(this);\n    var trace = cd[0].trace;\n    var group = Lib.ensureSingle(plotGroup, 'g', 'lines');\n\n    if (!trace.connector || !trace.connector.visible || !trace.connector.line.width) {\n      group.remove();\n      return;\n    }\n\n    var isHorizontal = trace.orientation === 'h';\n    var connectors = group.selectAll('g.line').data(Lib.identity);\n    connectors.enter().append('g').classed('line', true);\n    connectors.exit().remove();\n    var len = connectors.size();\n    connectors.each(function (di, i) {\n      // don't draw lines between nulls\n      if (i !== len - 1 && !di.cNext) return;\n      var xy = getXY(di, xa, ya, isHorizontal);\n      var x = xy[0];\n      var y = xy[1];\n      var shape = '';\n\n      if (x[3] !== undefined && y[3] !== undefined) {\n        if (isHorizontal) {\n          shape += 'M' + x[0] + ',' + y[1] + 'L' + x[2] + ',' + y[2];\n          shape += 'M' + x[1] + ',' + y[1] + 'L' + x[3] + ',' + y[2];\n        } else {\n          shape += 'M' + x[1] + ',' + y[1] + 'L' + x[2] + ',' + y[3];\n          shape += 'M' + x[1] + ',' + y[0] + 'L' + x[2] + ',' + y[2];\n        }\n      }\n\n      if (shape === '') shape = 'M0,0Z';\n      Lib.ensureSingle(d3.select(this), 'path').attr('d', shape).call(Drawing.setClipUrl, plotinfo.layerClipId, gd);\n    });\n  });\n}\n\nfunction getXY(di, xa, ya, isHorizontal) {\n  var s = [];\n  var p = [];\n  var sAxis = isHorizontal ? xa : ya;\n  var pAxis = isHorizontal ? ya : xa;\n  s[0] = sAxis.c2p(di.s0, true);\n  p[0] = pAxis.c2p(di.p0, true);\n  s[1] = sAxis.c2p(di.s1, true);\n  p[1] = pAxis.c2p(di.p1, true);\n  s[2] = sAxis.c2p(di.nextS0, true);\n  p[2] = pAxis.c2p(di.nextP0, true);\n  s[3] = sAxis.c2p(di.nextS1, true);\n  p[3] = pAxis.c2p(di.nextP1, true);\n  return isHorizontal ? [s, p] : [p, s];\n}","map":{"version":3,"sources":["C:/Projects/reactApp/analyse_coderhub/node_modules/plotly.js/src/traces/funnel/plot.js"],"names":["d3","require","Lib","Drawing","BADNUM","barPlot","clearMinTextSize","module","exports","plot","gd","plotinfo","cdModule","traceLayer","fullLayout","_fullLayout","plotConnectorRegions","plotConnectorLines","mode","funnelmode","norm","gap","funnelgap","groupgap","funnelgroupgap","xa","xaxis","ya","yaxis","makeTraceGroups","each","cd","plotGroup","select","trace","group","ensureSingle","connector","visible","remove","isHorizontal","orientation","connectors","selectAll","data","identity","enter","append","classed","exit","len","size","di","i","cNext","xy","getXY","x","y","shape","attr","call","setClipUrl","layerClipId","line","width","undefined","s","p","sAxis","pAxis","c2p","s0","p0","s1","p1","nextS0","nextP0","nextS1","nextP1"],"mappings":"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","sourcesContent":["'use strict';\n\nvar d3 = require('@plotly/d3');\nvar Lib = require('../../lib');\nvar Drawing = require('../../components/drawing');\nvar BADNUM = require('../../constants/numerical').BADNUM;\nvar barPlot = require('../bar/plot');\nvar clearMinTextSize = require('../bar/uniform_text').clearMinTextSize;\n\nmodule.exports = function plot(gd, plotinfo, cdModule, traceLayer) {\n    var fullLayout = gd._fullLayout;\n\n    clearMinTextSize('funnel', fullLayout);\n\n    plotConnectorRegions(gd, plotinfo, cdModule, traceLayer);\n    plotConnectorLines(gd, plotinfo, cdModule, traceLayer);\n\n    barPlot.plot(gd, plotinfo, cdModule, traceLayer, {\n        mode: fullLayout.funnelmode,\n        norm: fullLayout.funnelmode,\n        gap: fullLayout.funnelgap,\n        groupgap: fullLayout.funnelgroupgap\n    });\n};\n\nfunction plotConnectorRegions(gd, plotinfo, cdModule, traceLayer) {\n    var xa = plotinfo.xaxis;\n    var ya = plotinfo.yaxis;\n\n    Lib.makeTraceGroups(traceLayer, cdModule, 'trace bars').each(function(cd) {\n        var plotGroup = d3.select(this);\n        var trace = cd[0].trace;\n\n        var group = Lib.ensureSingle(plotGroup, 'g', 'regions');\n\n        if(!trace.connector || !trace.connector.visible) {\n            group.remove();\n            return;\n        }\n\n        var isHorizontal = (trace.orientation === 'h');\n\n        var connectors = group.selectAll('g.region').data(Lib.identity);\n\n        connectors.enter().append('g')\n            .classed('region', true);\n\n        connectors.exit().remove();\n\n        var len = connectors.size();\n\n        connectors.each(function(di, i) {\n            // don't draw lines between nulls\n            if(i !== len - 1 && !di.cNext) return;\n\n            var xy = getXY(di, xa, ya, isHorizontal);\n            var x = xy[0];\n            var y = xy[1];\n\n            var shape = '';\n\n            if(\n                x[0] !== BADNUM && y[0] !== BADNUM &&\n                x[1] !== BADNUM && y[1] !== BADNUM &&\n                x[2] !== BADNUM && y[2] !== BADNUM &&\n                x[3] !== BADNUM && y[3] !== BADNUM\n            ) {\n                if(isHorizontal) {\n                    shape += 'M' + x[0] + ',' + y[1] + 'L' + x[2] + ',' + y[2] + 'H' + x[3] + 'L' + x[1] + ',' + y[1] + 'Z';\n                } else {\n                    shape += 'M' + x[1] + ',' + y[1] + 'L' + x[2] + ',' + y[3] + 'V' + y[2] + 'L' + x[1] + ',' + y[0] + 'Z';\n                }\n            }\n\n            if(shape === '') shape = 'M0,0Z';\n\n            Lib.ensureSingle(d3.select(this), 'path')\n                .attr('d', shape)\n                .call(Drawing.setClipUrl, plotinfo.layerClipId, gd);\n        });\n    });\n}\n\nfunction plotConnectorLines(gd, plotinfo, cdModule, traceLayer) {\n    var xa = plotinfo.xaxis;\n    var ya = plotinfo.yaxis;\n\n    Lib.makeTraceGroups(traceLayer, cdModule, 'trace bars').each(function(cd) {\n        var plotGroup = d3.select(this);\n        var trace = cd[0].trace;\n\n        var group = Lib.ensureSingle(plotGroup, 'g', 'lines');\n\n        if(!trace.connector || !trace.connector.visible || !trace.connector.line.width) {\n            group.remove();\n            return;\n        }\n\n        var isHorizontal = (trace.orientation === 'h');\n\n        var connectors = group.selectAll('g.line').data(Lib.identity);\n\n        connectors.enter().append('g')\n            .classed('line', true);\n\n        connectors.exit().remove();\n\n        var len = connectors.size();\n\n        connectors.each(function(di, i) {\n            // don't draw lines between nulls\n            if(i !== len - 1 && !di.cNext) return;\n\n            var xy = getXY(di, xa, ya, isHorizontal);\n            var x = xy[0];\n            var y = xy[1];\n\n            var shape = '';\n\n            if(x[3] !== undefined && y[3] !== undefined) {\n                if(isHorizontal) {\n                    shape += 'M' + x[0] + ',' + y[1] + 'L' + x[2] + ',' + y[2];\n                    shape += 'M' + x[1] + ',' + y[1] + 'L' + x[3] + ',' + y[2];\n                } else {\n                    shape += 'M' + x[1] + ',' + y[1] + 'L' + x[2] + ',' + y[3];\n                    shape += 'M' + x[1] + ',' + y[0] + 'L' + x[2] + ',' + y[2];\n                }\n            }\n\n            if(shape === '') shape = 'M0,0Z';\n\n            Lib.ensureSingle(d3.select(this), 'path')\n                .attr('d', shape)\n                .call(Drawing.setClipUrl, plotinfo.layerClipId, gd);\n        });\n    });\n}\n\nfunction getXY(di, xa, ya, isHorizontal) {\n    var s = [];\n    var p = [];\n\n    var sAxis = isHorizontal ? xa : ya;\n    var pAxis = isHorizontal ? ya : xa;\n\n    s[0] = sAxis.c2p(di.s0, true);\n    p[0] = pAxis.c2p(di.p0, true);\n\n    s[1] = sAxis.c2p(di.s1, true);\n    p[1] = pAxis.c2p(di.p1, true);\n\n    s[2] = sAxis.c2p(di.nextS0, true);\n    p[2] = pAxis.c2p(di.nextP0, true);\n\n    s[3] = sAxis.c2p(di.nextS1, true);\n    p[3] = pAxis.c2p(di.nextP1, true);\n\n    return isHorizontal ? [s, p] : [p, s];\n}\n"]},"metadata":{},"sourceType":"script"}