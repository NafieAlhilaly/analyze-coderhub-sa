{"ast":null,"code":"'use strict';\n\nvar Lib = require('../lib');\n\nvar toImage = require('../plot_api/to_image');\n\nvar fileSaver = require('./filesaver');\n\nvar helpers = require('./helpers');\n/**\n * Plotly.downloadImage\n *\n * @param {object | string | HTML div} gd\n *   can either be a data/layout/config object\n *   or an existing graph <div>\n *   or an id to an existing graph <div>\n * @param {object} opts (see Plotly.toImage in ../plot_api/to_image)\n * @return {promise}\n */\n\n\nfunction downloadImage(gd, opts) {\n  var _gd;\n\n  if (!Lib.isPlainObject(gd)) _gd = Lib.getGraphDiv(gd);\n  opts = opts || {};\n  opts.format = opts.format || 'png';\n  opts.width = opts.width || null;\n  opts.height = opts.height || null;\n  opts.imageDataOnly = true;\n  return new Promise(function (resolve, reject) {\n    if (_gd && _gd._snapshotInProgress) {\n      reject(new Error('Snapshotting already in progress.'));\n    } // see comments within svgtoimg for additional\n    //   discussion of problems with IE\n    //   can now draw to canvas, but CORS tainted canvas\n    //   does not allow toDataURL\n    //   svg format will work though\n\n\n    if (Lib.isIE() && opts.format !== 'svg') {\n      reject(new Error(helpers.MSG_IE_BAD_FORMAT));\n    }\n\n    if (_gd) _gd._snapshotInProgress = true;\n    var promise = toImage(gd, opts);\n    var filename = opts.filename || gd.fn || 'newplot';\n    filename += '.' + opts.format.replace('-', '.');\n    promise.then(function (result) {\n      if (_gd) _gd._snapshotInProgress = false;\n      return fileSaver(result, filename, opts.format);\n    }).then(function (name) {\n      resolve(name);\n    }).catch(function (err) {\n      if (_gd) _gd._snapshotInProgress = false;\n      reject(err);\n    });\n  });\n}\n\nmodule.exports = downloadImage;","map":{"version":3,"sources":["C:/Projects/reactApp/analyse_coderhub/node_modules/plotly.js/src/snapshot/download.js"],"names":["Lib","require","toImage","fileSaver","helpers","downloadImage","gd","opts","_gd","isPlainObject","getGraphDiv","format","width","height","imageDataOnly","Promise","resolve","reject","_snapshotInProgress","Error","isIE","MSG_IE_BAD_FORMAT","promise","filename","fn","replace","then","result","name","catch","err","module","exports"],"mappings":"AAAA;;AAEA,IAAIA,GAAG,GAAGC,OAAO,CAAC,QAAD,CAAjB;;AAEA,IAAIC,OAAO,GAAGD,OAAO,CAAC,sBAAD,CAArB;;AAEA,IAAIE,SAAS,GAAGF,OAAO,CAAC,aAAD,CAAvB;;AACA,IAAIG,OAAO,GAAGH,OAAO,CAAC,WAAD,CAArB;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AACA,SAASI,aAAT,CAAuBC,EAAvB,EAA2BC,IAA3B,EAAiC;AAC7B,MAAIC,GAAJ;;AACA,MAAG,CAACR,GAAG,CAACS,aAAJ,CAAkBH,EAAlB,CAAJ,EAA2BE,GAAG,GAAGR,GAAG,CAACU,WAAJ,CAAgBJ,EAAhB,CAAN;AAE3BC,EAAAA,IAAI,GAAGA,IAAI,IAAI,EAAf;AACAA,EAAAA,IAAI,CAACI,MAAL,GAAcJ,IAAI,CAACI,MAAL,IAAe,KAA7B;AACAJ,EAAAA,IAAI,CAACK,KAAL,GAAaL,IAAI,CAACK,KAAL,IAAc,IAA3B;AACAL,EAAAA,IAAI,CAACM,MAAL,GAAcN,IAAI,CAACM,MAAL,IAAe,IAA7B;AACAN,EAAAA,IAAI,CAACO,aAAL,GAAqB,IAArB;AAEA,SAAO,IAAIC,OAAJ,CAAY,UAASC,OAAT,EAAkBC,MAAlB,EAA0B;AACzC,QAAGT,GAAG,IAAIA,GAAG,CAACU,mBAAd,EAAmC;AAC/BD,MAAAA,MAAM,CAAC,IAAIE,KAAJ,CAAU,mCAAV,CAAD,CAAN;AACH,KAHwC,CAKzC;AACA;AACA;AACA;AACA;;;AACA,QAAGnB,GAAG,CAACoB,IAAJ,MAAcb,IAAI,CAACI,MAAL,KAAgB,KAAjC,EAAwC;AACpCM,MAAAA,MAAM,CAAC,IAAIE,KAAJ,CAAUf,OAAO,CAACiB,iBAAlB,CAAD,CAAN;AACH;;AAED,QAAGb,GAAH,EAAQA,GAAG,CAACU,mBAAJ,GAA0B,IAA1B;AACR,QAAII,OAAO,GAAGpB,OAAO,CAACI,EAAD,EAAKC,IAAL,CAArB;AAEA,QAAIgB,QAAQ,GAAGhB,IAAI,CAACgB,QAAL,IAAiBjB,EAAE,CAACkB,EAApB,IAA0B,SAAzC;AACAD,IAAAA,QAAQ,IAAI,MAAMhB,IAAI,CAACI,MAAL,CAAYc,OAAZ,CAAoB,GAApB,EAAyB,GAAzB,CAAlB;AAEAH,IAAAA,OAAO,CAACI,IAAR,CAAa,UAASC,MAAT,EAAiB;AAC1B,UAAGnB,GAAH,EAAQA,GAAG,CAACU,mBAAJ,GAA0B,KAA1B;AACR,aAAOf,SAAS,CAACwB,MAAD,EAASJ,QAAT,EAAmBhB,IAAI,CAACI,MAAxB,CAAhB;AACH,KAHD,EAGGe,IAHH,CAGQ,UAASE,IAAT,EAAe;AACnBZ,MAAAA,OAAO,CAACY,IAAD,CAAP;AACH,KALD,EAKGC,KALH,CAKS,UAASC,GAAT,EAAc;AACnB,UAAGtB,GAAH,EAAQA,GAAG,CAACU,mBAAJ,GAA0B,KAA1B;AACRD,MAAAA,MAAM,CAACa,GAAD,CAAN;AACH,KARD;AASH,GA7BM,CAAP;AA8BH;;AAEDC,MAAM,CAACC,OAAP,GAAiB3B,aAAjB","sourcesContent":["'use strict';\n\nvar Lib = require('../lib');\n\nvar toImage = require('../plot_api/to_image');\n\nvar fileSaver = require('./filesaver');\nvar helpers = require('./helpers');\n\n/**\n * Plotly.downloadImage\n *\n * @param {object | string | HTML div} gd\n *   can either be a data/layout/config object\n *   or an existing graph <div>\n *   or an id to an existing graph <div>\n * @param {object} opts (see Plotly.toImage in ../plot_api/to_image)\n * @return {promise}\n */\nfunction downloadImage(gd, opts) {\n    var _gd;\n    if(!Lib.isPlainObject(gd)) _gd = Lib.getGraphDiv(gd);\n\n    opts = opts || {};\n    opts.format = opts.format || 'png';\n    opts.width = opts.width || null;\n    opts.height = opts.height || null;\n    opts.imageDataOnly = true;\n\n    return new Promise(function(resolve, reject) {\n        if(_gd && _gd._snapshotInProgress) {\n            reject(new Error('Snapshotting already in progress.'));\n        }\n\n        // see comments within svgtoimg for additional\n        //   discussion of problems with IE\n        //   can now draw to canvas, but CORS tainted canvas\n        //   does not allow toDataURL\n        //   svg format will work though\n        if(Lib.isIE() && opts.format !== 'svg') {\n            reject(new Error(helpers.MSG_IE_BAD_FORMAT));\n        }\n\n        if(_gd) _gd._snapshotInProgress = true;\n        var promise = toImage(gd, opts);\n\n        var filename = opts.filename || gd.fn || 'newplot';\n        filename += '.' + opts.format.replace('-', '.');\n\n        promise.then(function(result) {\n            if(_gd) _gd._snapshotInProgress = false;\n            return fileSaver(result, filename, opts.format);\n        }).then(function(name) {\n            resolve(name);\n        }).catch(function(err) {\n            if(_gd) _gd._snapshotInProgress = false;\n            reject(err);\n        });\n    });\n}\n\nmodule.exports = downloadImage;\n"]},"metadata":{},"sourceType":"script"}