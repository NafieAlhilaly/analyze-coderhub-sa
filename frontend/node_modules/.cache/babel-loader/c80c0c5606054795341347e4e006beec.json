{"ast":null,"code":"\"use strict\";\n\nvar bounds = require(\"binary-search-bounds\");\n\nvar NOT_FOUND = 0;\nvar SUCCESS = 1;\nvar EMPTY = 2;\nmodule.exports = createWrapper;\n\nfunction IntervalTreeNode(mid, left, right, leftPoints, rightPoints) {\n  this.mid = mid;\n  this.left = left;\n  this.right = right;\n  this.leftPoints = leftPoints;\n  this.rightPoints = rightPoints;\n  this.count = (left ? left.count : 0) + (right ? right.count : 0) + leftPoints.length;\n}\n\nvar proto = IntervalTreeNode.prototype;\n\nfunction copy(a, b) {\n  a.mid = b.mid;\n  a.left = b.left;\n  a.right = b.right;\n  a.leftPoints = b.leftPoints;\n  a.rightPoints = b.rightPoints;\n  a.count = b.count;\n}\n\nfunction rebuild(node, intervals) {\n  var ntree = createIntervalTree(intervals);\n  node.mid = ntree.mid;\n  node.left = ntree.left;\n  node.right = ntree.right;\n  node.leftPoints = ntree.leftPoints;\n  node.rightPoints = ntree.rightPoints;\n  node.count = ntree.count;\n}\n\nfunction rebuildWithInterval(node, interval) {\n  var intervals = node.intervals([]);\n  intervals.push(interval);\n  rebuild(node, intervals);\n}\n\nfunction rebuildWithoutInterval(node, interval) {\n  var intervals = node.intervals([]);\n  var idx = intervals.indexOf(interval);\n\n  if (idx < 0) {\n    return NOT_FOUND;\n  }\n\n  intervals.splice(idx, 1);\n  rebuild(node, intervals);\n  return SUCCESS;\n}\n\nproto.intervals = function (result) {\n  result.push.apply(result, this.leftPoints);\n\n  if (this.left) {\n    this.left.intervals(result);\n  }\n\n  if (this.right) {\n    this.right.intervals(result);\n  }\n\n  return result;\n};\n\nproto.insert = function (interval) {\n  var weight = this.count - this.leftPoints.length;\n  this.count += 1;\n\n  if (interval[1] < this.mid) {\n    if (this.left) {\n      if (4 * (this.left.count + 1) > 3 * (weight + 1)) {\n        rebuildWithInterval(this, interval);\n      } else {\n        this.left.insert(interval);\n      }\n    } else {\n      this.left = createIntervalTree([interval]);\n    }\n  } else if (interval[0] > this.mid) {\n    if (this.right) {\n      if (4 * (this.right.count + 1) > 3 * (weight + 1)) {\n        rebuildWithInterval(this, interval);\n      } else {\n        this.right.insert(interval);\n      }\n    } else {\n      this.right = createIntervalTree([interval]);\n    }\n  } else {\n    var l = bounds.ge(this.leftPoints, interval, compareBegin);\n    var r = bounds.ge(this.rightPoints, interval, compareEnd);\n    this.leftPoints.splice(l, 0, interval);\n    this.rightPoints.splice(r, 0, interval);\n  }\n};\n\nproto.remove = function (interval) {\n  var weight = this.count - this.leftPoints;\n\n  if (interval[1] < this.mid) {\n    if (!this.left) {\n      return NOT_FOUND;\n    }\n\n    var rw = this.right ? this.right.count : 0;\n\n    if (4 * rw > 3 * (weight - 1)) {\n      return rebuildWithoutInterval(this, interval);\n    }\n\n    var r = this.left.remove(interval);\n\n    if (r === EMPTY) {\n      this.left = null;\n      this.count -= 1;\n      return SUCCESS;\n    } else if (r === SUCCESS) {\n      this.count -= 1;\n    }\n\n    return r;\n  } else if (interval[0] > this.mid) {\n    if (!this.right) {\n      return NOT_FOUND;\n    }\n\n    var lw = this.left ? this.left.count : 0;\n\n    if (4 * lw > 3 * (weight - 1)) {\n      return rebuildWithoutInterval(this, interval);\n    }\n\n    var r = this.right.remove(interval);\n\n    if (r === EMPTY) {\n      this.right = null;\n      this.count -= 1;\n      return SUCCESS;\n    } else if (r === SUCCESS) {\n      this.count -= 1;\n    }\n\n    return r;\n  } else {\n    if (this.count === 1) {\n      if (this.leftPoints[0] === interval) {\n        return EMPTY;\n      } else {\n        return NOT_FOUND;\n      }\n    }\n\n    if (this.leftPoints.length === 1 && this.leftPoints[0] === interval) {\n      if (this.left && this.right) {\n        var p = this;\n        var n = this.left;\n\n        while (n.right) {\n          p = n;\n          n = n.right;\n        }\n\n        if (p === this) {\n          n.right = this.right;\n        } else {\n          var l = this.left;\n          var r = this.right;\n          p.count -= n.count;\n          p.right = n.left;\n          n.left = l;\n          n.right = r;\n        }\n\n        copy(this, n);\n        this.count = (this.left ? this.left.count : 0) + (this.right ? this.right.count : 0) + this.leftPoints.length;\n      } else if (this.left) {\n        copy(this, this.left);\n      } else {\n        copy(this, this.right);\n      }\n\n      return SUCCESS;\n    }\n\n    for (var l = bounds.ge(this.leftPoints, interval, compareBegin); l < this.leftPoints.length; ++l) {\n      if (this.leftPoints[l][0] !== interval[0]) {\n        break;\n      }\n\n      if (this.leftPoints[l] === interval) {\n        this.count -= 1;\n        this.leftPoints.splice(l, 1);\n\n        for (var r = bounds.ge(this.rightPoints, interval, compareEnd); r < this.rightPoints.length; ++r) {\n          if (this.rightPoints[r][1] !== interval[1]) {\n            break;\n          } else if (this.rightPoints[r] === interval) {\n            this.rightPoints.splice(r, 1);\n            return SUCCESS;\n          }\n        }\n      }\n    }\n\n    return NOT_FOUND;\n  }\n};\n\nfunction reportLeftRange(arr, hi, cb) {\n  for (var i = 0; i < arr.length && arr[i][0] <= hi; ++i) {\n    var r = cb(arr[i]);\n\n    if (r) {\n      return r;\n    }\n  }\n}\n\nfunction reportRightRange(arr, lo, cb) {\n  for (var i = arr.length - 1; i >= 0 && arr[i][1] >= lo; --i) {\n    var r = cb(arr[i]);\n\n    if (r) {\n      return r;\n    }\n  }\n}\n\nfunction reportRange(arr, cb) {\n  for (var i = 0; i < arr.length; ++i) {\n    var r = cb(arr[i]);\n\n    if (r) {\n      return r;\n    }\n  }\n}\n\nproto.queryPoint = function (x, cb) {\n  if (x < this.mid) {\n    if (this.left) {\n      var r = this.left.queryPoint(x, cb);\n\n      if (r) {\n        return r;\n      }\n    }\n\n    return reportLeftRange(this.leftPoints, x, cb);\n  } else if (x > this.mid) {\n    if (this.right) {\n      var r = this.right.queryPoint(x, cb);\n\n      if (r) {\n        return r;\n      }\n    }\n\n    return reportRightRange(this.rightPoints, x, cb);\n  } else {\n    return reportRange(this.leftPoints, cb);\n  }\n};\n\nproto.queryInterval = function (lo, hi, cb) {\n  if (lo < this.mid && this.left) {\n    var r = this.left.queryInterval(lo, hi, cb);\n\n    if (r) {\n      return r;\n    }\n  }\n\n  if (hi > this.mid && this.right) {\n    var r = this.right.queryInterval(lo, hi, cb);\n\n    if (r) {\n      return r;\n    }\n  }\n\n  if (hi < this.mid) {\n    return reportLeftRange(this.leftPoints, hi, cb);\n  } else if (lo > this.mid) {\n    return reportRightRange(this.rightPoints, lo, cb);\n  } else {\n    return reportRange(this.leftPoints, cb);\n  }\n};\n\nfunction compareNumbers(a, b) {\n  return a - b;\n}\n\nfunction compareBegin(a, b) {\n  var d = a[0] - b[0];\n\n  if (d) {\n    return d;\n  }\n\n  return a[1] - b[1];\n}\n\nfunction compareEnd(a, b) {\n  var d = a[1] - b[1];\n\n  if (d) {\n    return d;\n  }\n\n  return a[0] - b[0];\n}\n\nfunction createIntervalTree(intervals) {\n  if (intervals.length === 0) {\n    return null;\n  }\n\n  var pts = [];\n\n  for (var i = 0; i < intervals.length; ++i) {\n    pts.push(intervals[i][0], intervals[i][1]);\n  }\n\n  pts.sort(compareNumbers);\n  var mid = pts[pts.length >> 1];\n  var leftIntervals = [];\n  var rightIntervals = [];\n  var centerIntervals = [];\n\n  for (var i = 0; i < intervals.length; ++i) {\n    var s = intervals[i];\n\n    if (s[1] < mid) {\n      leftIntervals.push(s);\n    } else if (mid < s[0]) {\n      rightIntervals.push(s);\n    } else {\n      centerIntervals.push(s);\n    }\n  } //Split center intervals\n\n\n  var leftPoints = centerIntervals;\n  var rightPoints = centerIntervals.slice();\n  leftPoints.sort(compareBegin);\n  rightPoints.sort(compareEnd);\n  return new IntervalTreeNode(mid, createIntervalTree(leftIntervals), createIntervalTree(rightIntervals), leftPoints, rightPoints);\n} //User friendly wrapper that makes it possible to support empty trees\n\n\nfunction IntervalTree(root) {\n  this.root = root;\n}\n\nvar tproto = IntervalTree.prototype;\n\ntproto.insert = function (interval) {\n  if (this.root) {\n    this.root.insert(interval);\n  } else {\n    this.root = new IntervalTreeNode(interval[0], null, null, [interval], [interval]);\n  }\n};\n\ntproto.remove = function (interval) {\n  if (this.root) {\n    var r = this.root.remove(interval);\n\n    if (r === EMPTY) {\n      this.root = null;\n    }\n\n    return r !== NOT_FOUND;\n  }\n\n  return false;\n};\n\ntproto.queryPoint = function (p, cb) {\n  if (this.root) {\n    return this.root.queryPoint(p, cb);\n  }\n};\n\ntproto.queryInterval = function (lo, hi, cb) {\n  if (lo <= hi && this.root) {\n    return this.root.queryInterval(lo, hi, cb);\n  }\n};\n\nObject.defineProperty(tproto, \"count\", {\n  get: function () {\n    if (this.root) {\n      return this.root.count;\n    }\n\n    return 0;\n  }\n});\nObject.defineProperty(tproto, \"intervals\", {\n  get: function () {\n    if (this.root) {\n      return this.root.intervals([]);\n    }\n\n    return [];\n  }\n});\n\nfunction createWrapper(intervals) {\n  if (!intervals || intervals.length === 0) {\n    return new IntervalTree(null);\n  }\n\n  return new IntervalTree(createIntervalTree(intervals));\n}","map":{"version":3,"sources":["C:/Projects/reactApp/analyse_coderhub/node_modules/interval-tree-1d/interval-tree.js"],"names":["bounds","require","NOT_FOUND","SUCCESS","EMPTY","module","exports","createWrapper","IntervalTreeNode","mid","left","right","leftPoints","rightPoints","count","length","proto","prototype","copy","a","b","rebuild","node","intervals","ntree","createIntervalTree","rebuildWithInterval","interval","push","rebuildWithoutInterval","idx","indexOf","splice","result","apply","insert","weight","l","ge","compareBegin","r","compareEnd","remove","rw","lw","p","n","reportLeftRange","arr","hi","cb","i","reportRightRange","lo","reportRange","queryPoint","x","queryInterval","compareNumbers","d","pts","sort","leftIntervals","rightIntervals","centerIntervals","s","slice","IntervalTree","root","tproto","Object","defineProperty","get"],"mappings":"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","sourcesContent":["\"use strict\"\n\nvar bounds = require(\"binary-search-bounds\")\n\nvar NOT_FOUND = 0\nvar SUCCESS = 1\nvar EMPTY = 2\n\nmodule.exports = createWrapper\n\nfunction IntervalTreeNode(mid, left, right, leftPoints, rightPoints) {\n  this.mid = mid\n  this.left = left\n  this.right = right\n  this.leftPoints = leftPoints\n  this.rightPoints = rightPoints\n  this.count = (left ? left.count : 0) + (right ? right.count : 0) + leftPoints.length\n}\n\nvar proto = IntervalTreeNode.prototype\n\nfunction copy(a, b) {\n  a.mid = b.mid\n  a.left = b.left\n  a.right = b.right\n  a.leftPoints = b.leftPoints\n  a.rightPoints = b.rightPoints\n  a.count = b.count\n}\n\nfunction rebuild(node, intervals) {\n  var ntree = createIntervalTree(intervals)\n  node.mid = ntree.mid\n  node.left = ntree.left\n  node.right = ntree.right\n  node.leftPoints = ntree.leftPoints\n  node.rightPoints = ntree.rightPoints\n  node.count = ntree.count\n}\n\nfunction rebuildWithInterval(node, interval) {\n  var intervals = node.intervals([])\n  intervals.push(interval)\n  rebuild(node, intervals)    \n}\n\nfunction rebuildWithoutInterval(node, interval) {\n  var intervals = node.intervals([])\n  var idx = intervals.indexOf(interval)\n  if(idx < 0) {\n    return NOT_FOUND\n  }\n  intervals.splice(idx, 1)\n  rebuild(node, intervals)\n  return SUCCESS\n}\n\nproto.intervals = function(result) {\n  result.push.apply(result, this.leftPoints)\n  if(this.left) {\n    this.left.intervals(result)\n  }\n  if(this.right) {\n    this.right.intervals(result)\n  }\n  return result\n}\n\nproto.insert = function(interval) {\n  var weight = this.count - this.leftPoints.length\n  this.count += 1\n  if(interval[1] < this.mid) {\n    if(this.left) {\n      if(4*(this.left.count+1) > 3*(weight+1)) {\n        rebuildWithInterval(this, interval)\n      } else {\n        this.left.insert(interval)\n      }\n    } else {\n      this.left = createIntervalTree([interval])\n    }\n  } else if(interval[0] > this.mid) {\n    if(this.right) {\n      if(4*(this.right.count+1) > 3*(weight+1)) {\n        rebuildWithInterval(this, interval)\n      } else {\n        this.right.insert(interval)\n      }\n    } else {\n      this.right = createIntervalTree([interval])\n    }\n  } else {\n    var l = bounds.ge(this.leftPoints, interval, compareBegin)\n    var r = bounds.ge(this.rightPoints, interval, compareEnd)\n    this.leftPoints.splice(l, 0, interval)\n    this.rightPoints.splice(r, 0, interval)\n  }\n}\n\nproto.remove = function(interval) {\n  var weight = this.count - this.leftPoints\n  if(interval[1] < this.mid) {\n    if(!this.left) {\n      return NOT_FOUND\n    }\n    var rw = this.right ? this.right.count : 0\n    if(4 * rw > 3 * (weight-1)) {\n      return rebuildWithoutInterval(this, interval)\n    }\n    var r = this.left.remove(interval)\n    if(r === EMPTY) {\n      this.left = null\n      this.count -= 1\n      return SUCCESS\n    } else if(r === SUCCESS) {\n      this.count -= 1\n    }\n    return r\n  } else if(interval[0] > this.mid) {\n    if(!this.right) {\n      return NOT_FOUND\n    }\n    var lw = this.left ? this.left.count : 0\n    if(4 * lw > 3 * (weight-1)) {\n      return rebuildWithoutInterval(this, interval)\n    }\n    var r = this.right.remove(interval)\n    if(r === EMPTY) {\n      this.right = null\n      this.count -= 1\n      return SUCCESS\n    } else if(r === SUCCESS) {\n      this.count -= 1\n    }\n    return r\n  } else {\n    if(this.count === 1) {\n      if(this.leftPoints[0] === interval) {\n        return EMPTY\n      } else {\n        return NOT_FOUND\n      }\n    }\n    if(this.leftPoints.length === 1 && this.leftPoints[0] === interval) {\n      if(this.left && this.right) {\n        var p = this\n        var n = this.left\n        while(n.right) {\n          p = n\n          n = n.right\n        }\n        if(p === this) {\n          n.right = this.right\n        } else {\n          var l = this.left\n          var r = this.right\n          p.count -= n.count\n          p.right = n.left\n          n.left = l\n          n.right = r\n        }\n        copy(this, n)\n        this.count = (this.left?this.left.count:0) + (this.right?this.right.count:0) + this.leftPoints.length\n      } else if(this.left) {\n        copy(this, this.left)\n      } else {\n        copy(this, this.right)\n      }\n      return SUCCESS\n    }\n    for(var l = bounds.ge(this.leftPoints, interval, compareBegin); l<this.leftPoints.length; ++l) {\n      if(this.leftPoints[l][0] !== interval[0]) {\n        break\n      }\n      if(this.leftPoints[l] === interval) {\n        this.count -= 1\n        this.leftPoints.splice(l, 1)\n        for(var r = bounds.ge(this.rightPoints, interval, compareEnd); r<this.rightPoints.length; ++r) {\n          if(this.rightPoints[r][1] !== interval[1]) {\n            break\n          } else if(this.rightPoints[r] === interval) {\n            this.rightPoints.splice(r, 1)\n            return SUCCESS\n          }\n        }\n      }\n    }\n    return NOT_FOUND\n  }\n}\n\nfunction reportLeftRange(arr, hi, cb) {\n  for(var i=0; i<arr.length && arr[i][0] <= hi; ++i) {\n    var r = cb(arr[i])\n    if(r) { return r }\n  }\n}\n\nfunction reportRightRange(arr, lo, cb) {\n  for(var i=arr.length-1; i>=0 && arr[i][1] >= lo; --i) {\n    var r = cb(arr[i])\n    if(r) { return r }\n  }\n}\n\nfunction reportRange(arr, cb) {\n  for(var i=0; i<arr.length; ++i) {\n    var r = cb(arr[i])\n    if(r) { return r }\n  }\n}\n\nproto.queryPoint = function(x, cb) {\n  if(x < this.mid) {\n    if(this.left) {\n      var r = this.left.queryPoint(x, cb)\n      if(r) { return r }\n    }\n    return reportLeftRange(this.leftPoints, x, cb)\n  } else if(x > this.mid) {\n    if(this.right) {\n      var r = this.right.queryPoint(x, cb)\n      if(r) { return r }\n    }\n    return reportRightRange(this.rightPoints, x, cb)\n  } else {\n    return reportRange(this.leftPoints, cb)\n  }\n}\n\nproto.queryInterval = function(lo, hi, cb) {\n  if(lo < this.mid && this.left) {\n    var r = this.left.queryInterval(lo, hi, cb)\n    if(r) { return r }\n  }\n  if(hi > this.mid && this.right) {\n    var r = this.right.queryInterval(lo, hi, cb)\n    if(r) { return r }\n  }\n  if(hi < this.mid) {\n    return reportLeftRange(this.leftPoints, hi, cb)\n  } else if(lo > this.mid) {\n    return reportRightRange(this.rightPoints, lo, cb)\n  } else {\n    return reportRange(this.leftPoints, cb)\n  }\n}\n\nfunction compareNumbers(a, b) {\n  return a - b\n}\n\nfunction compareBegin(a, b) {\n  var d = a[0] - b[0]\n  if(d) { return d }\n  return a[1] - b[1]\n}\n\nfunction compareEnd(a, b) {\n  var d = a[1] - b[1]\n  if(d) { return d }\n  return a[0] - b[0]\n}\n\nfunction createIntervalTree(intervals) {\n  if(intervals.length === 0) {\n    return null\n  }\n  var pts = []\n  for(var i=0; i<intervals.length; ++i) {\n    pts.push(intervals[i][0], intervals[i][1])\n  }\n  pts.sort(compareNumbers)\n\n  var mid = pts[pts.length>>1]\n\n  var leftIntervals = []\n  var rightIntervals = []\n  var centerIntervals = []\n  for(var i=0; i<intervals.length; ++i) {\n    var s = intervals[i]\n    if(s[1] < mid) {\n      leftIntervals.push(s)\n    } else if(mid < s[0]) {\n      rightIntervals.push(s)\n    } else {\n      centerIntervals.push(s)\n    }\n  }\n\n  //Split center intervals\n  var leftPoints = centerIntervals\n  var rightPoints = centerIntervals.slice()\n  leftPoints.sort(compareBegin)\n  rightPoints.sort(compareEnd)\n\n  return new IntervalTreeNode(mid, \n    createIntervalTree(leftIntervals),\n    createIntervalTree(rightIntervals),\n    leftPoints,\n    rightPoints)\n}\n\n//User friendly wrapper that makes it possible to support empty trees\nfunction IntervalTree(root) {\n  this.root = root\n}\n\nvar tproto = IntervalTree.prototype\n\ntproto.insert = function(interval) {\n  if(this.root) {\n    this.root.insert(interval)\n  } else {\n    this.root = new IntervalTreeNode(interval[0], null, null, [interval], [interval])\n  }\n}\n\ntproto.remove = function(interval) {\n  if(this.root) {\n    var r = this.root.remove(interval)\n    if(r === EMPTY) {\n      this.root = null\n    }\n    return r !== NOT_FOUND\n  }\n  return false\n}\n\ntproto.queryPoint = function(p, cb) {\n  if(this.root) {\n    return this.root.queryPoint(p, cb)\n  }\n}\n\ntproto.queryInterval = function(lo, hi, cb) {\n  if(lo <= hi && this.root) {\n    return this.root.queryInterval(lo, hi, cb)\n  }\n}\n\nObject.defineProperty(tproto, \"count\", {\n  get: function() {\n    if(this.root) {\n      return this.root.count\n    }\n    return 0\n  }\n})\n\nObject.defineProperty(tproto, \"intervals\", {\n  get: function() {\n    if(this.root) {\n      return this.root.intervals([])\n    }\n    return []\n  }\n})\n\nfunction createWrapper(intervals) {\n  if(!intervals || intervals.length === 0) {\n    return new IntervalTree(null)\n  }\n  return new IntervalTree(createIntervalTree(intervals))\n}\n"]},"metadata":{},"sourceType":"script"}