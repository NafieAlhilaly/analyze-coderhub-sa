{"ast":null,"code":"'use strict';\n\nvar Registry = require('../../registry');\n\nvar Lib = require('../../lib');\n\nvar colorscaleDefaults = require('../../components/colorscale/defaults');\n\nvar attributes = require('./attributes');\n\nvar MIN = 0.1; // Note: often we don't want the data cube to be disappeared\n\nfunction createWave(n, minOpacity) {\n  var arr = [];\n  var steps = 32; // Max: 256\n\n  for (var i = 0; i < steps; i++) {\n    var u = i / (steps - 1);\n    var v = minOpacity + (1 - minOpacity) * (1 - Math.pow(Math.sin(n * u * Math.PI), 2));\n    arr.push([u, Math.max(0, Math.min(1, v))]);\n  }\n\n  return arr;\n}\n\nfunction isValidScaleArray(scl) {\n  var highestVal = 0;\n  if (!Array.isArray(scl) || scl.length < 2) return false;\n  if (!scl[0] || !scl[scl.length - 1]) return false;\n  if (+scl[0][0] !== 0 || +scl[scl.length - 1][0] !== 1) return false;\n\n  for (var i = 0; i < scl.length; i++) {\n    var si = scl[i];\n\n    if (si.length !== 2 || +si[0] < highestVal) {\n      return false;\n    }\n\n    highestVal = +si[0];\n  }\n\n  return true;\n}\n\nfunction supplyDefaults(traceIn, traceOut, defaultColor, layout) {\n  var i, j;\n\n  function coerce(attr, dflt) {\n    return Lib.coerce(traceIn, traceOut, attributes, attr, dflt);\n  }\n\n  var x = coerce('x');\n  var y = coerce('y');\n  var z = coerce('z');\n\n  if (!z || !z.length || (x ? x.length < 1 : false) || (y ? y.length < 1 : false)) {\n    traceOut.visible = false;\n    return;\n  }\n\n  traceOut._xlength = Array.isArray(x) && Lib.isArrayOrTypedArray(x[0]) ? z.length : z[0].length;\n  traceOut._ylength = z.length;\n  var handleCalendarDefaults = Registry.getComponentMethod('calendars', 'handleTraceDefaults');\n  handleCalendarDefaults(traceIn, traceOut, ['x', 'y', 'z'], layout);\n  coerce('text');\n  coerce('hovertext');\n  coerce('hovertemplate');\n  coerce('xhoverformat');\n  coerce('yhoverformat');\n  coerce('zhoverformat'); // Coerce remaining properties\n\n  ['lighting.ambient', 'lighting.diffuse', 'lighting.specular', 'lighting.roughness', 'lighting.fresnel', 'lightposition.x', 'lightposition.y', 'lightposition.z', 'hidesurface', 'connectgaps', 'opacity'].forEach(function (x) {\n    coerce(x);\n  });\n  var surfaceColor = coerce('surfacecolor');\n  var dims = ['x', 'y', 'z'];\n\n  for (i = 0; i < 3; ++i) {\n    var contourDim = 'contours.' + dims[i];\n    var show = coerce(contourDim + '.show');\n    var highlight = coerce(contourDim + '.highlight');\n\n    if (show || highlight) {\n      for (j = 0; j < 3; ++j) {\n        coerce(contourDim + '.project.' + dims[j]);\n      }\n    }\n\n    if (show) {\n      coerce(contourDim + '.color');\n      coerce(contourDim + '.width');\n      coerce(contourDim + '.usecolormap');\n    }\n\n    if (highlight) {\n      coerce(contourDim + '.highlightcolor');\n      coerce(contourDim + '.highlightwidth');\n    }\n\n    coerce(contourDim + '.start');\n    coerce(contourDim + '.end');\n    coerce(contourDim + '.size');\n  } // backward compatibility block\n\n\n  if (!surfaceColor) {\n    mapLegacy(traceIn, 'zmin', 'cmin');\n    mapLegacy(traceIn, 'zmax', 'cmax');\n    mapLegacy(traceIn, 'zauto', 'cauto');\n  } // TODO if contours.?.usecolormap are false and hidesurface is true\n  // the colorbar shouldn't be shown by default\n\n\n  colorscaleDefaults(traceIn, traceOut, layout, coerce, {\n    prefix: '',\n    cLetter: 'c'\n  });\n  opacityscaleDefaults(traceIn, traceOut, layout, coerce); // disable 1D transforms - currently surface does NOT support column data like heatmap does\n  // you can use mesh3d for this use case, but not surface\n\n  traceOut._length = null;\n}\n\nfunction opacityscaleDefaults(traceIn, traceOut, layout, coerce) {\n  var opacityscale = coerce('opacityscale');\n\n  if (opacityscale === 'max') {\n    traceOut.opacityscale = [[0, MIN], [1, 1]];\n  } else if (opacityscale === 'min') {\n    traceOut.opacityscale = [[0, 1], [1, MIN]];\n  } else if (opacityscale === 'extremes') {\n    traceOut.opacityscale = createWave(1, MIN);\n  } else if (!isValidScaleArray(opacityscale)) {\n    traceOut.opacityscale = undefined;\n  }\n}\n\nfunction mapLegacy(traceIn, oldAttr, newAttr) {\n  if (oldAttr in traceIn && !(newAttr in traceIn)) {\n    traceIn[newAttr] = traceIn[oldAttr];\n  }\n}\n\nmodule.exports = {\n  supplyDefaults: supplyDefaults,\n  opacityscaleDefaults: opacityscaleDefaults\n};","map":{"version":3,"sources":["C:/Projects/reactApp/analyse_coderhub/node_modules/plotly.js/src/traces/surface/defaults.js"],"names":["Registry","require","Lib","colorscaleDefaults","attributes","MIN","createWave","n","minOpacity","arr","steps","i","u","v","Math","pow","sin","PI","push","max","min","isValidScaleArray","scl","highestVal","Array","isArray","length","si","supplyDefaults","traceIn","traceOut","defaultColor","layout","j","coerce","attr","dflt","x","y","z","visible","_xlength","isArrayOrTypedArray","_ylength","handleCalendarDefaults","getComponentMethod","forEach","surfaceColor","dims","contourDim","show","highlight","mapLegacy","prefix","cLetter","opacityscaleDefaults","_length","opacityscale","undefined","oldAttr","newAttr","module","exports"],"mappings":"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","sourcesContent":["'use strict';\n\nvar Registry = require('../../registry');\nvar Lib = require('../../lib');\n\nvar colorscaleDefaults = require('../../components/colorscale/defaults');\nvar attributes = require('./attributes');\n\nvar MIN = 0.1; // Note: often we don't want the data cube to be disappeared\n\nfunction createWave(n, minOpacity) {\n    var arr = [];\n    var steps = 32; // Max: 256\n    for(var i = 0; i < steps; i++) {\n        var u = i / (steps - 1);\n        var v = minOpacity + (1 - minOpacity) * (1 - Math.pow(Math.sin(n * u * Math.PI), 2));\n        arr.push([\n            u,\n            Math.max(0, Math.min(1, v))\n        ]);\n    }\n    return arr;\n}\n\nfunction isValidScaleArray(scl) {\n    var highestVal = 0;\n\n    if(!Array.isArray(scl) || scl.length < 2) return false;\n\n    if(!scl[0] || !scl[scl.length - 1]) return false;\n\n    if(+scl[0][0] !== 0 || +scl[scl.length - 1][0] !== 1) return false;\n\n    for(var i = 0; i < scl.length; i++) {\n        var si = scl[i];\n\n        if(si.length !== 2 || +si[0] < highestVal) {\n            return false;\n        }\n\n        highestVal = +si[0];\n    }\n\n    return true;\n}\n\nfunction supplyDefaults(traceIn, traceOut, defaultColor, layout) {\n    var i, j;\n\n    function coerce(attr, dflt) {\n        return Lib.coerce(traceIn, traceOut, attributes, attr, dflt);\n    }\n\n    var x = coerce('x');\n    var y = coerce('y');\n\n    var z = coerce('z');\n    if(!z || !z.length ||\n       (x ? (x.length < 1) : false) ||\n       (y ? (y.length < 1) : false)\n    ) {\n        traceOut.visible = false;\n        return;\n    }\n\n    traceOut._xlength = (Array.isArray(x) && Lib.isArrayOrTypedArray(x[0])) ? z.length : z[0].length;\n    traceOut._ylength = z.length;\n\n    var handleCalendarDefaults = Registry.getComponentMethod('calendars', 'handleTraceDefaults');\n    handleCalendarDefaults(traceIn, traceOut, ['x', 'y', 'z'], layout);\n\n    coerce('text');\n    coerce('hovertext');\n    coerce('hovertemplate');\n    coerce('xhoverformat');\n    coerce('yhoverformat');\n    coerce('zhoverformat');\n\n    // Coerce remaining properties\n    [\n        'lighting.ambient',\n        'lighting.diffuse',\n        'lighting.specular',\n        'lighting.roughness',\n        'lighting.fresnel',\n        'lightposition.x',\n        'lightposition.y',\n        'lightposition.z',\n        'hidesurface',\n        'connectgaps',\n        'opacity'\n    ].forEach(function(x) { coerce(x); });\n\n    var surfaceColor = coerce('surfacecolor');\n\n    var dims = ['x', 'y', 'z'];\n    for(i = 0; i < 3; ++i) {\n        var contourDim = 'contours.' + dims[i];\n        var show = coerce(contourDim + '.show');\n        var highlight = coerce(contourDim + '.highlight');\n\n        if(show || highlight) {\n            for(j = 0; j < 3; ++j) {\n                coerce(contourDim + '.project.' + dims[j]);\n            }\n        }\n\n        if(show) {\n            coerce(contourDim + '.color');\n            coerce(contourDim + '.width');\n            coerce(contourDim + '.usecolormap');\n        }\n\n        if(highlight) {\n            coerce(contourDim + '.highlightcolor');\n            coerce(contourDim + '.highlightwidth');\n        }\n\n        coerce(contourDim + '.start');\n        coerce(contourDim + '.end');\n        coerce(contourDim + '.size');\n    }\n\n    // backward compatibility block\n    if(!surfaceColor) {\n        mapLegacy(traceIn, 'zmin', 'cmin');\n        mapLegacy(traceIn, 'zmax', 'cmax');\n        mapLegacy(traceIn, 'zauto', 'cauto');\n    }\n\n    // TODO if contours.?.usecolormap are false and hidesurface is true\n    // the colorbar shouldn't be shown by default\n\n    colorscaleDefaults(\n        traceIn, traceOut, layout, coerce, {prefix: '', cLetter: 'c'}\n    );\n\n    opacityscaleDefaults(traceIn, traceOut, layout, coerce);\n\n    // disable 1D transforms - currently surface does NOT support column data like heatmap does\n    // you can use mesh3d for this use case, but not surface\n    traceOut._length = null;\n}\n\nfunction opacityscaleDefaults(traceIn, traceOut, layout, coerce) {\n    var opacityscale = coerce('opacityscale');\n    if(opacityscale === 'max') {\n        traceOut.opacityscale = [[0, MIN], [1, 1]];\n    } else if(opacityscale === 'min') {\n        traceOut.opacityscale = [[0, 1], [1, MIN]];\n    } else if(opacityscale === 'extremes') {\n        traceOut.opacityscale = createWave(1, MIN);\n    } else if(!isValidScaleArray(opacityscale)) {\n        traceOut.opacityscale = undefined;\n    }\n}\n\nfunction mapLegacy(traceIn, oldAttr, newAttr) {\n    if(oldAttr in traceIn && !(newAttr in traceIn)) {\n        traceIn[newAttr] = traceIn[oldAttr];\n    }\n}\n\nmodule.exports = {\n    supplyDefaults: supplyDefaults,\n    opacityscaleDefaults: opacityscaleDefaults\n};\n"]},"metadata":{},"sourceType":"script"}